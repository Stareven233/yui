2022-04-18 21:25:03 train.py[line:150] INFO YuiConfigPro(RANDOM_SEED=233, DATASET_DIR='D:/A日常/大学/毕业设计/dataset/maestro-v3.0.0/', DATAMETA_NAME='maestro-v3.0.0_tinymp3.csv', WORKSPACE='D:/A日常/大学/毕业设计/code/yui/', MAX_INPUTS_LENGTH=512, MAX_TARGETS_LENGTH=1024, PROGRAM_GRANULARITY='flat', SAMPLE_RATE=16000, FRAME_SIZE=128, HOP_WIDTH=128, NUM_MEL_BINS=256, FFT_SIZE=2048, MEL_LO_HZ=20.0, MEL_HI_HZ=8000.0, PAD_ID=0, ENCODED_EOS_ID=1, ENCODED_UNK_ID=2, EXTRA_IDS=100, DECODED_EOS_ID=-1, DECODED_INVALID_ID=-2, STEPS_PER_SECOND=1000, MAX_SHIFT_SECONDS=10, NUM_VELOCITY_BINS=127, CUDA=True, BATCH_SIZE=4, NUM_WORKERS=2, NUM_EPOCHS=160, TRAIN_ITERATION=600, LEARNING_RATE=0.001, OVERFIT_PATIENCE=5)
2022-04-18 21:25:03 train.py[line:152] INFO Using GPU.
2022-04-18 21:25:03 train.py[line:153] INFO GPU number: 1
2022-04-18 21:25:03 train.py[line:176] INFO The model has 4,641,792 trainable parameters
2022-04-18 21:25:03 train.py[line:226] INFO resume_checkpoint_path='D:/A日常/大学/毕业设计/code/yui/checkpoints\\model_resume.pt' does not exist, train from scratch
2022-04-18 21:25:03 train.py[line:256] INFO -------train loop starts, start_time=1650288303.698s-------
2022-04-18 21:25:30 train.py[line:77] INFO train: epoch=0, iteration=20, loss=6.450858116149902, lr=[0.001], in 26.875s
2022-04-18 21:25:37 train.py[line:77] INFO train: epoch=0, iteration=40, loss=6.450091361999512, lr=[0.001], in 7.206s
2022-04-18 21:25:44 train.py[line:77] INFO train: epoch=0, iteration=60, loss=6.411162853240967, lr=[0.001], in 6.639s
2022-04-18 21:25:50 train.py[line:77] INFO train: epoch=0, iteration=80, loss=6.369204044342041, lr=[0.001], in 6.385s
2022-04-18 21:25:57 train.py[line:77] INFO train: epoch=0, iteration=100, loss=6.247185707092285, lr=[0.001], in 6.923s
2022-04-18 21:26:04 train.py[line:77] INFO train: epoch=0, iteration=120, loss=6.192133903503418, lr=[0.001], in 6.865s
2022-04-18 21:26:11 train.py[line:77] INFO train: epoch=0, iteration=140, loss=6.28303861618042, lr=[0.001], in 7.045s
2022-04-18 21:26:17 train.py[line:77] INFO train: epoch=0, iteration=160, loss=5.672372341156006, lr=[0.001], in 6.273s
2022-04-18 21:26:24 train.py[line:77] INFO train: epoch=0, iteration=180, loss=5.539299964904785, lr=[0.001], in 6.582s
2022-04-18 21:26:26 train.py[line:85] INFO -------train exits, epoch=0-------
2022-04-18 21:26:26 train.py[line:105] INFO -------eval starts, epoch=0-------
2022-04-18 21:26:40 train.py[line:130] INFO -------eval exits, epoch=0-------
2022-04-18 21:26:40 train.py[line:270] INFO epoch=0 finish, time=96.686s, train_loss=6.306372405373477, validate_loss=5.979224638505415, with lr=[0.001]
2022-04-18 21:26:40 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:26:57 train.py[line:77] INFO train: epoch=1, iteration=20, loss=5.715696334838867, lr=[0.001], in 16.744s
2022-04-18 21:27:12 train.py[line:77] INFO train: epoch=1, iteration=40, loss=5.957636833190918, lr=[0.001], in 14.957s
2022-04-18 21:27:19 train.py[line:77] INFO train: epoch=1, iteration=60, loss=5.7583441734313965, lr=[0.001], in 6.911s
2022-04-18 21:27:29 train.py[line:77] INFO train: epoch=1, iteration=80, loss=5.867313385009766, lr=[0.001], in 10.186s
2022-04-18 21:27:36 train.py[line:77] INFO train: epoch=1, iteration=100, loss=5.793368816375732, lr=[0.001], in 6.445s
2022-04-18 21:27:43 train.py[line:77] INFO train: epoch=1, iteration=120, loss=5.680999279022217, lr=[0.001], in 7.028s
2022-04-18 21:27:51 train.py[line:77] INFO train: epoch=1, iteration=140, loss=5.55645751953125, lr=[0.001], in 7.983s
2022-04-18 21:27:58 train.py[line:77] INFO train: epoch=1, iteration=160, loss=5.719045162200928, lr=[0.001], in 7.328s
2022-04-18 21:28:05 train.py[line:77] INFO train: epoch=1, iteration=180, loss=6.122781276702881, lr=[0.001], in 6.912s
2022-04-18 21:28:08 train.py[line:85] INFO -------train exits, epoch=1-------
2022-04-18 21:28:08 train.py[line:105] INFO -------eval starts, epoch=1-------
2022-04-18 21:28:22 train.py[line:130] INFO -------eval exits, epoch=1-------
2022-04-18 21:28:22 train.py[line:270] INFO epoch=1 finish, time=101.649s, train_loss=5.849554800218152, validate_loss=5.993582682176069, with lr=[0.001]
2022-04-18 21:28:22 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:28:48 train.py[line:77] INFO train: epoch=2, iteration=20, loss=5.704724311828613, lr=[0.001], in 25.880s
2022-04-18 21:28:54 train.py[line:77] INFO train: epoch=2, iteration=40, loss=5.756161689758301, lr=[0.001], in 6.707s
2022-04-18 21:29:01 train.py[line:77] INFO train: epoch=2, iteration=60, loss=5.60712194442749, lr=[0.001], in 6.377s
2022-04-18 21:29:08 train.py[line:77] INFO train: epoch=2, iteration=80, loss=5.463537216186523, lr=[0.001], in 7.207s
2022-04-18 21:29:15 train.py[line:77] INFO train: epoch=2, iteration=100, loss=5.464381694793701, lr=[0.001], in 6.877s
2022-04-18 21:29:21 train.py[line:77] INFO train: epoch=2, iteration=120, loss=5.590958118438721, lr=[0.001], in 6.630s
2022-04-18 21:29:29 train.py[line:77] INFO train: epoch=2, iteration=140, loss=5.709712505340576, lr=[0.001], in 7.442s
2022-04-18 21:29:35 train.py[line:77] INFO train: epoch=2, iteration=160, loss=5.768224239349365, lr=[0.001], in 6.600s
2022-04-18 21:29:42 train.py[line:77] INFO train: epoch=2, iteration=180, loss=5.557028293609619, lr=[0.001], in 6.243s
2022-04-18 21:29:44 train.py[line:85] INFO -------train exits, epoch=2-------
2022-04-18 21:29:44 train.py[line:105] INFO -------eval starts, epoch=2-------
2022-04-18 21:30:02 train.py[line:130] INFO -------eval exits, epoch=2-------
2022-04-18 21:30:02 train.py[line:270] INFO epoch=2 finish, time=99.996s, train_loss=5.717683866459836, validate_loss=5.844430923461914, with lr=[0.001]
2022-04-18 21:30:02 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:30:27 train.py[line:77] INFO train: epoch=3, iteration=20, loss=5.376415252685547, lr=[0.001], in 25.212s
2022-04-18 21:30:33 train.py[line:77] INFO train: epoch=3, iteration=40, loss=5.489363670349121, lr=[0.001], in 6.534s
2022-04-18 21:30:40 train.py[line:77] INFO train: epoch=3, iteration=60, loss=5.711806297302246, lr=[0.001], in 6.743s
2022-04-18 21:30:47 train.py[line:77] INFO train: epoch=3, iteration=80, loss=6.004258632659912, lr=[0.001], in 6.600s
2022-04-18 21:30:56 train.py[line:77] INFO train: epoch=3, iteration=100, loss=5.583823204040527, lr=[0.001], in 8.921s
2022-04-18 21:31:02 train.py[line:77] INFO train: epoch=3, iteration=120, loss=5.6072893142700195, lr=[0.001], in 6.164s
2022-04-18 21:31:10 train.py[line:77] INFO train: epoch=3, iteration=140, loss=5.655254364013672, lr=[0.001], in 8.590s
2022-04-18 21:31:17 train.py[line:77] INFO train: epoch=3, iteration=160, loss=5.381724834442139, lr=[0.001], in 6.860s
2022-04-18 21:31:23 train.py[line:77] INFO train: epoch=3, iteration=180, loss=5.444069862365723, lr=[0.001], in 6.162s
2022-04-18 21:31:26 train.py[line:85] INFO -------train exits, epoch=3-------
2022-04-18 21:31:26 train.py[line:105] INFO -------eval starts, epoch=3-------
2022-04-18 21:31:39 train.py[line:130] INFO -------eval exits, epoch=3-------
2022-04-18 21:31:39 train.py[line:270] INFO epoch=3 finish, time=97.785s, train_loss=5.642049999647243, validate_loss=5.842402458190918, with lr=[0.001]
2022-04-18 21:31:39 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:32:06 train.py[line:77] INFO train: epoch=4, iteration=20, loss=5.7418646812438965, lr=[0.001], in 26.313s
2022-04-18 21:32:13 train.py[line:77] INFO train: epoch=4, iteration=40, loss=5.6298651695251465, lr=[0.001], in 6.771s
2022-04-18 21:32:19 train.py[line:77] INFO train: epoch=4, iteration=60, loss=5.681728363037109, lr=[0.001], in 6.713s
2022-04-18 21:32:26 train.py[line:77] INFO train: epoch=4, iteration=80, loss=5.8045854568481445, lr=[0.001], in 6.481s
2022-04-18 21:32:32 train.py[line:77] INFO train: epoch=4, iteration=100, loss=5.631669044494629, lr=[0.001], in 6.541s
2022-04-18 21:32:39 train.py[line:77] INFO train: epoch=4, iteration=120, loss=5.6211113929748535, lr=[0.001], in 6.920s
2022-04-18 21:32:46 train.py[line:77] INFO train: epoch=4, iteration=140, loss=5.671613693237305, lr=[0.001], in 7.215s
2022-04-18 21:32:54 train.py[line:77] INFO train: epoch=4, iteration=160, loss=5.868274211883545, lr=[0.001], in 7.203s
2022-04-18 21:32:59 train.py[line:77] INFO train: epoch=4, iteration=180, loss=5.47744607925415, lr=[0.001], in 5.630s
2022-04-18 21:33:01 train.py[line:85] INFO -------train exits, epoch=4-------
2022-04-18 21:33:01 train.py[line:105] INFO -------eval starts, epoch=4-------
2022-04-18 21:33:15 train.py[line:130] INFO -------eval exits, epoch=4-------
2022-04-18 21:33:15 train.py[line:270] INFO epoch=4 finish, time=95.163s, train_loss=5.596410689815398, validate_loss=5.7625581134449355, with lr=[0.001]
2022-04-18 21:33:15 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:33:41 train.py[line:77] INFO train: epoch=5, iteration=20, loss=5.433172225952148, lr=[0.001], in 26.238s
2022-04-18 21:33:47 train.py[line:77] INFO train: epoch=5, iteration=40, loss=5.47620153427124, lr=[0.001], in 6.312s
2022-04-18 21:33:54 train.py[line:77] INFO train: epoch=5, iteration=60, loss=5.636202335357666, lr=[0.001], in 6.585s
2022-04-18 21:34:01 train.py[line:77] INFO train: epoch=5, iteration=80, loss=5.892003536224365, lr=[0.001], in 6.932s
2022-04-18 21:34:07 train.py[line:77] INFO train: epoch=5, iteration=100, loss=5.699954509735107, lr=[0.001], in 6.443s
2022-04-18 21:34:14 train.py[line:77] INFO train: epoch=5, iteration=120, loss=5.607381820678711, lr=[0.001], in 6.576s
2022-04-18 21:34:21 train.py[line:77] INFO train: epoch=5, iteration=140, loss=5.811765193939209, lr=[0.001], in 6.874s
2022-04-18 21:34:27 train.py[line:77] INFO train: epoch=5, iteration=160, loss=5.340773105621338, lr=[0.001], in 6.666s
2022-04-18 21:34:35 train.py[line:77] INFO train: epoch=5, iteration=180, loss=5.568183898925781, lr=[0.001], in 8.109s
2022-04-18 21:34:37 train.py[line:85] INFO -------train exits, epoch=5-------
2022-04-18 21:34:37 train.py[line:105] INFO -------eval starts, epoch=5-------
2022-04-18 21:34:51 train.py[line:130] INFO -------eval exits, epoch=5-------
2022-04-18 21:34:51 train.py[line:270] INFO epoch=5 finish, time=96.000s, train_loss=5.572577504701512, validate_loss=5.8123439875516025, with lr=[0.001]
2022-04-18 21:34:51 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:35:08 train.py[line:77] INFO train: epoch=6, iteration=20, loss=5.518285751342773, lr=[0.001], in 17.614s
2022-04-18 21:35:24 train.py[line:77] INFO train: epoch=6, iteration=40, loss=5.646978378295898, lr=[0.001], in 15.893s
2022-04-18 21:35:31 train.py[line:77] INFO train: epoch=6, iteration=60, loss=5.619682788848877, lr=[0.001], in 6.937s
2022-04-18 21:35:38 train.py[line:77] INFO train: epoch=6, iteration=80, loss=5.515775680541992, lr=[0.001], in 6.697s
2022-04-18 21:35:45 train.py[line:77] INFO train: epoch=6, iteration=100, loss=5.635528564453125, lr=[0.001], in 6.772s
2022-04-18 21:35:51 train.py[line:77] INFO train: epoch=6, iteration=120, loss=5.680632591247559, lr=[0.001], in 6.788s
2022-04-18 21:35:58 train.py[line:77] INFO train: epoch=6, iteration=140, loss=5.429259777069092, lr=[0.001], in 6.545s
2022-04-18 21:36:05 train.py[line:77] INFO train: epoch=6, iteration=160, loss=5.453752040863037, lr=[0.001], in 7.030s
2022-04-18 21:36:11 train.py[line:77] INFO train: epoch=6, iteration=180, loss=5.676287651062012, lr=[0.001], in 6.423s
2022-04-18 21:36:15 train.py[line:85] INFO -------train exits, epoch=6-------
2022-04-18 21:36:15 train.py[line:105] INFO -------eval starts, epoch=6-------
2022-04-18 21:36:28 train.py[line:130] INFO -------eval exits, epoch=6-------
2022-04-18 21:36:28 train.py[line:270] INFO epoch=6 finish, time=97.335s, train_loss=5.562349653499012, validate_loss=5.884744210676714, with lr=[0.001]
2022-04-18 21:36:28 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:36:55 train.py[line:77] INFO train: epoch=7, iteration=20, loss=5.6360321044921875, lr=[0.001], in 26.688s
2022-04-18 21:37:03 train.py[line:77] INFO train: epoch=7, iteration=40, loss=5.537985801696777, lr=[0.001], in 8.387s
2022-04-18 21:37:09 train.py[line:77] INFO train: epoch=7, iteration=60, loss=5.74259614944458, lr=[0.001], in 6.321s
2022-04-18 21:37:16 train.py[line:77] INFO train: epoch=7, iteration=80, loss=5.532296657562256, lr=[0.001], in 6.781s
2022-04-18 21:37:23 train.py[line:77] INFO train: epoch=7, iteration=100, loss=5.8035736083984375, lr=[0.001], in 6.655s
2022-04-18 21:37:30 train.py[line:77] INFO train: epoch=7, iteration=120, loss=5.860156536102295, lr=[0.001], in 6.907s
2022-04-18 21:37:37 train.py[line:77] INFO train: epoch=7, iteration=140, loss=5.48089075088501, lr=[0.001], in 6.863s
2022-04-18 21:37:43 train.py[line:77] INFO train: epoch=7, iteration=160, loss=6.0107011795043945, lr=[0.001], in 6.866s
2022-04-18 21:37:52 train.py[line:77] INFO train: epoch=7, iteration=180, loss=5.443422794342041, lr=[0.001], in 8.252s
2022-04-18 21:37:54 train.py[line:85] INFO -------train exits, epoch=7-------
2022-04-18 21:37:54 train.py[line:105] INFO -------eval starts, epoch=7-------
2022-04-18 21:38:07 train.py[line:130] INFO -------eval exits, epoch=7-------
2022-04-18 21:38:07 train.py[line:270] INFO epoch=7 finish, time=99.118s, train_loss=5.583263635635376, validate_loss=5.757531556216153, with lr=[0.001]
2022-04-18 21:38:07 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:38:33 train.py[line:77] INFO train: epoch=8, iteration=20, loss=5.617599964141846, lr=[0.001], in 26.199s
2022-04-18 21:38:40 train.py[line:77] INFO train: epoch=8, iteration=40, loss=5.543302536010742, lr=[0.001], in 6.361s
2022-04-18 21:38:46 train.py[line:77] INFO train: epoch=8, iteration=60, loss=5.507298946380615, lr=[0.001], in 6.445s
2022-04-18 21:38:53 train.py[line:77] INFO train: epoch=8, iteration=80, loss=5.604259490966797, lr=[0.001], in 6.533s
2022-04-18 21:38:59 train.py[line:77] INFO train: epoch=8, iteration=100, loss=5.84979248046875, lr=[0.001], in 6.294s
2022-04-18 21:39:06 train.py[line:77] INFO train: epoch=8, iteration=120, loss=5.731350898742676, lr=[0.001], in 6.590s
2022-04-18 21:39:12 train.py[line:77] INFO train: epoch=8, iteration=140, loss=5.522125244140625, lr=[0.001], in 6.384s
2022-04-18 21:39:18 train.py[line:77] INFO train: epoch=8, iteration=160, loss=5.375699520111084, lr=[0.001], in 6.477s
2022-04-18 21:39:25 train.py[line:77] INFO train: epoch=8, iteration=180, loss=5.815066337585449, lr=[0.001], in 6.199s
2022-04-18 21:39:34 train.py[line:85] INFO -------train exits, epoch=8-------
2022-04-18 21:39:34 train.py[line:105] INFO -------eval starts, epoch=8-------
2022-04-18 21:39:47 train.py[line:130] INFO -------eval exits, epoch=8-------
2022-04-18 21:39:47 train.py[line:270] INFO epoch=8 finish, time=99.989s, train_loss=5.591561837629839, validate_loss=5.856807491996071, with lr=[0.001]
2022-04-18 21:39:47 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:40:14 train.py[line:77] INFO train: epoch=9, iteration=20, loss=5.984106540679932, lr=[0.001], in 26.458s
2022-04-18 21:40:20 train.py[line:77] INFO train: epoch=9, iteration=40, loss=5.82791805267334, lr=[0.001], in 6.876s
2022-04-18 21:40:29 train.py[line:77] INFO train: epoch=9, iteration=60, loss=5.898650646209717, lr=[0.001], in 8.884s
2022-04-18 21:40:37 train.py[line:77] INFO train: epoch=9, iteration=80, loss=5.822661876678467, lr=[0.001], in 8.047s
2022-04-18 21:40:46 train.py[line:77] INFO train: epoch=9, iteration=100, loss=5.731954574584961, lr=[0.001], in 8.565s
2022-04-18 21:40:55 train.py[line:77] INFO train: epoch=9, iteration=120, loss=5.971858978271484, lr=[0.001], in 9.507s
2022-04-18 21:41:02 train.py[line:77] INFO train: epoch=9, iteration=140, loss=5.868219375610352, lr=[0.001], in 6.700s
2022-04-18 21:41:11 train.py[line:77] INFO train: epoch=9, iteration=160, loss=5.938590049743652, lr=[0.001], in 8.833s
2022-04-18 21:41:17 train.py[line:77] INFO train: epoch=9, iteration=180, loss=5.54740047454834, lr=[0.001], in 5.668s
2022-04-18 21:41:19 train.py[line:85] INFO -------train exits, epoch=9-------
2022-04-18 21:41:19 train.py[line:105] INFO -------eval starts, epoch=9-------
2022-04-18 21:41:32 train.py[line:130] INFO -------eval exits, epoch=9-------
2022-04-18 21:41:32 train.py[line:270] INFO epoch=9 finish, time=104.839s, train_loss=5.766854491285098, validate_loss=5.857469775459983, with lr=[0.001]
2022-04-18 21:41:32 train.py[line:299] INFO save model and statistics to D:/A日常/大学/毕业设计/code/yui/checkpoints
2022-04-18 21:41:48 train.py[line:77] INFO train: epoch=10, iteration=20, loss=5.609385013580322, lr=[0.001], in 16.010s
2022-04-18 21:42:03 train.py[line:77] INFO train: epoch=10, iteration=40, loss=6.020498275756836, lr=[0.001], in 15.244s
2022-04-18 21:42:10 train.py[line:77] INFO train: epoch=10, iteration=60, loss=5.893427848815918, lr=[0.001], in 6.565s
2022-04-18 21:42:16 train.py[line:77] INFO train: epoch=10, iteration=80, loss=5.696202278137207, lr=[0.001], in 6.494s
2022-04-18 21:42:23 train.py[line:77] INFO train: epoch=10, iteration=100, loss=5.671688556671143, lr=[0.001], in 6.400s
2022-04-18 21:42:29 train.py[line:77] INFO train: epoch=10, iteration=120, loss=5.7298583984375, lr=[0.001], in 6.533s
2022-04-18 21:42:36 train.py[line:77] INFO train: epoch=10, iteration=140, loss=5.675604820251465, lr=[0.001], in 6.428s
2022-04-18 21:42:42 train.py[line:77] INFO train: epoch=10, iteration=160, loss=5.718114376068115, lr=[0.001], in 6.691s
2022-04-18 21:42:49 train.py[line:77] INFO train: epoch=10, iteration=180, loss=6.146374702453613, lr=[0.001], in 6.904s
2022-04-18 21:42:53 train.py[line:85] INFO -------train exits, epoch=10-------
2022-04-18 21:42:53 train.py[line:105] INFO -------eval starts, epoch=10-------
